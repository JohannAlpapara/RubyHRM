<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Employees</h1>
    </div>
</div>

<div class="panel panel-default">
	<div class="panel-heading"><i class="fa fa-search fa-fw"></i> Search Employees</div>
	<div class="panel-body">
		<%= form_tag(people_path, :method => "get", id: "search-form", :class => "form-inline") do %>
			<div class="form-group col-lg-3">
				<%= text_field_tag :search, params[:search], :placeholder => "Search Name", :class => "form-control" %>
				<%= submit_tag "Search", :name => nil, :class =>  "btn btn-default" %>
			</div>
		<% end %>
	</div>
</div>

<div class="panel panel-default">
	<div class="panel-heading"><i class="fa fa-th-list fa-fw"></i> Employees</div>
	<div class="panel-body">
		<%= link_to new_person_path, :class => "btn btn-success" do %>
			<i class="fa fa-plus fa-fw"></i> Add New Employee
		<% end %>
		<br/><br/>
		<% if @people.empty? %>
			<p>There were no results found.</p>
		<% else %>	
			<div class="table-responsive">
				<table class="table table-striped table-bordered table-hover">
					<thead>
						<tr>
							<th>Employee ID</th>
							<th>First Name</th>
							<th>Last Name</th>
							<th>Job Title</th>
							<th>Department</th>
							<th>Supervisor(s)</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
						<% @people.each do |p| %>
						<tr>
							<td><%= p.employee_id %></td>
							<td><%= p.first_name %></td>
							<td><%= p.last_name %></td>
							<% if p.job_detail.present? %>
							<td><%= p.job_detail.job_title.job_title unless p.job_detail.job_title_id.blank? %></td>
							<td><%= p.job_detail.department.name unless p.job_detail.department_id.blank? %></td>
							<% else %>
							<td></td>
							<td></td>
							<% end %>
							<td>
								<%= p.reporting_relationships.map { |rr| rr.manager.full_name}.join(", ") %>
							</td>
							<td>
								<%= link_to person_path(p.id), :class => "btn btn-success btn-xs" do %>
									<i class="fa fa-search fa-fw"></i> View
								<% end %>
							</td>
						</tr>
						<% end %>
					</tbody>
				</table>
			</div>
		<% end %>
		</div>
	</div>
</div>


